<!doctype html>
<html>
<head>
  <title>NBIS</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<header class="top-bar">
  <div>
    <strong>NBIS</strong><br>
    <small>Nearby Business Intelligence</small>
  </div>

  <button class="location-btn" onclick="getLocation()">üìç Use My Location</button>
</header>

<section class="controls">

  <input type="text"
         id="searchInput"
         placeholder="Search places"
         oninput="filterCards()">

  <!-- CATEGORY -->
  <select id="categoryFilter" onchange="filterCards()">
    <option value="all">All Categories</option>
    {% for c in categories %}
      <option value="{{ c }}">{{ c }}</option>
    {% endfor %}
  </select>

  <!-- SORT BY DISTANCE -->
  <select id="sortOption" onchange="sortCards()">
    <option value="name">Sort by Name</option>
    <option value="distance">Sort by Distance</option>
  </select>

  <!-- RADIUS -->
  <input type="range" min="1000" max="10000" step="1000"
         value="{{ radius }}"
         oninput="updateRadius(this.value)">
  <span id="radiusValue">{{ radius//1000 }} km</span>

</section>

<main class="results" id="cardsContainer">

{% for r in results %}
  <div class="card"
       data-name="{{ r.name|lower }}"
       data-category="{{ r.group }}"
       data-distance="{{ r.distance }}">

    <h3>{{ r.name }}</h3>
    <p class="category">{{ r.group }}</p>
    <p>üìç {{ r.distance }} km away</p>

    <a class="map-btn"
       href="https://www.google.com/maps?q={{ r.lat }},{{ r.lon }}"
       target="_blank">
       View in Maps ‚Üí
    </a>
  </div>
{% endfor %}

</main>

<script src="/static/app.js"></script>

<script>
function getLocation() {
  navigator.geolocation.getCurrentPosition(pos => {
    location.href = `/?lat=${pos.coords.latitude}&lon=${pos.coords.longitude}`;
  });
}
</script>

</body>
</html>
